import java.io._
val sites = 450
val chroms = Array(("chr1",158337067),("chr2",137060424),("chr3",121430405),("chr4",120829699),("chr5",121191424),("chr6",119458736),("chr7",112638659),("chr8",113384836),("chr9",105708250),("chr10",104305016),("chr11",107310763),("chr12",91163125),("chr13",84240350),("chr14",84648390),("chr15",85296676),("chr16",81724687),("chr17",75158596),("chr18",66004023),("chr19",64057457),("chr20",72042655),("chr21",71599096),("chr22",61435874),("chr23",52530062),("chr24",62714930),("chr25",42904170),("chr26",51681464),("chr27",45407902),("chr28",46312546),("chr29",51505224))//,("chrX",148823899))
var counter = 0
val targets = Array(("chr1",115519809),("chr1",149489203),("chr10",77716195),("chr12",13628279),("chr15",35646563),("chr20",2360223),("chr23",12095221),("chr24",23115734),("chr24",38190323),("chr24",56196619),("chr25",27994213),("chr26",40597995),("chr27",36201351),("chr5",71962703),("chr5",6861679),("chr6",118790997),("chr7",90900394),("chr8",43070773),("chr8",96790619),("chr9",31244848),("chr9",89281704),("chr9",97971669),("chr1",41313438),("chr13",269951),("chr4",97570098),("chr9",94659376),("chr17",18341063),("chr17",18341064),("chr16",36935662),("chr1",40322338),("chr1",102572388),("chr10",99404404),("chr12",61044380),("chr15",64854239),("chr17",44935626),("chr18",3524670),("chr18",52944261),("chr18",57943907),("chr19",44008942),("chr19",58643612),("chr2",17808887),("chr2",45310117),("chr2",127442937),("chr22",13470264),("chr23",16542746),("chr23",18926474),("chr25",11803736),("chr27",2547177),("chr28",30319465),("chr3",37662421),("chr3",101332168),("chr4",17814546),("chr4",23364341),("chr5",55618302),("chr5",67810919),("chr9",23443925),("chr25",11856580),("chr16",73107056),("chr2",78865032),("chr20",25091614),("chr3",111532558),("chr9",103901845),("chr1",45112139),("chr3",118051613),("chr1",50852124),("chr13",18027703),("chr17",31098258),("chr17",40932501),("chr2",4480740),("chr23",5417650),("chr26",3948521),("chr26",37392827),("chr28",4578225),("chr3",109374348),("chr4",91557652),("chr6",1547985),("chr6",96148979),("chr15",4162203),("chr15",4605478),("chr17",47965992),("chr2",114677629),("chr1",36639047),("chr1",79285604),("chr11",102319959),("chr12",32520767),("chr29",21015326),("chr5",16835906),("chr7",25520314),("chr9",27624878),("chr9",51904795),("chr9",103409590),("chr3",119254978),("chr7",15550103),("chr1",693537),("chr1",18339991),("chr1",152071121),("chr10",22395723),("chr10",24951484),("chr10",37090070),("chr12",5532786),("chr19",16439219),("chr19",54525893),("chr2",23371752),("chr21",14687675),("chr21",71563441),("chr22",8055734),("chr23",856097),("chr28",21647139),("chr3",54368535),("chr3",54368560),("chr3",112379287),("chr4",7326723),("chr4",33214542),("chr5",74999685),("chr1",44450082),("chr11",1605132),("chr11",96742531),("chr11",97768985),("chr17",61988678),("chr18",9297584),("chr19",4903105),("chr2",47765807),("chr21",13896243),("chr21",38952807),("chr23",36494344),("chr26",24474576),("chr27",21834986),("chr4",79281447),("chr7",13740327),("chr8",15468426),("chr1",114543107),("chr14",1644588),("chr17",16664450),("chr19",35611952),("chr19",1247325),("chr19",1265836),("chr19",10979940),("chr19",11006386),("chr20",48455410),("chr22",37613114),("chr29",31303289),("chr3",10607905),("chr5",77921785),("chr1",124777804),("chr12",73280531),("chr21",17237142),("chr8",94444859),("chr11",32614617),("chr11",54767345),("chr13",2354563),("chr13",10607401),("chr13",13098225),("chr13",53112257),("chr14",23469956),("chr15",61042090),("chr18",28515218),("chr27",42810469),("chr6",41369457),("chr6",76258523),("chr9",53443264),("chr1",91609939),("chr1",130052540),("chr11",72264438),("chr2",103593689),("chr25",40748714),("chr28",13671174),("chr7",74195737),("chr9",47112868),("chr2",8381298),("chr23",41611888),("chr1",70040334),("chr10",24136504),("chr10",24136507),("chr14",70067308),("chr2",112361828),("chr5",21558749),("chr5",86638261),("chr7",69467357),("chr2",97372319),("chr13",2523187),("chr4",39663179),("chr26",45214485),("chr21",30842309),("chr22",42857601),("chr7",18638627),("chr4",81234158),("chr1",11379372),("chr18",64915241),("chr19",38625464),("chr20",53322141),("chr21",63361113),("chr22",38009844),("chr24",9752151),("chr24",35209697),("chr24",43387983),("chr24",43387985),("chr29",50206030),("chr3",12622174),("chr7",75151058),("chr9",69177001),("chr9",5820081),("chr17",24520649),("chr10",24839664),("chr16",924183),("chr22",11899998),("chr6",90670113),("chr14",82643467),("chr17",10447474),("chr5",89216139),("chr5",89216144),("chr5",89216146),("chr17",42276603),("chr8",112128570),("chr17",46811571),("chr26",7348437),("chr5",8743134),("chr4",17108542),("chr4",40424615),("chr6",21950345),("chr13",21363737),("chr29",3416251),("chr13",26725465),("chr11",82969272),("chr14",3888080),("chr17",70143316),("chr19",60593494),("chr4",111870446),("chr8",31372887),("chr26",36774923),("chr20",15891423),("chr9",49370611),("chr2",114686043),("chr1",51910329),("chr1",72951069),("chr11",35306013),("chr11",35306025),("chr12",59391803),("chr13",14636354),("chr14",55799049),("chr2",14339958),("chr20",47007900),("chr21",64806901),("chr22",34170768),("chr25",40438599),("chr26",10183274),("chr4",58194693),("chr6",76921012),("chr6",7548686),("chr7",18754672),("chr9",91760323),("chr23",52456938),("chr12",87938762),("chr11",891337),("chr1",126381931),("chr14",72823072),("chr20",64353624),("chr21",70782567),("chr3",8930112),("chr4",18640002),("chr17",15961079),("chr10",491674),("chr1",87204364),("chr10",24136532),("chr19",39024025),("chr5",73758467),("chr5",14377692),("chr7",33795084),("chr9",91606167),("chr9",96048216),("chr25",17184438),("chr19",12559790),("chr2",79427071),("chr9",86942337),("chr9",18384195),("chr1",39434050),("chr16",24270355),("chr20",34577075),("chr8",7280825),("chr10",89207266),("chr13",44847941),("chr15",70929240),("chr21",25583086),("chr4",117704053),("chr6",112271783),("chr8",102736509),("chr1",158083951),("chr11",66328634),("chr11",82712035),("chr13",66089833),("chr14",74564459),("chr15",18960315),("chr19",32084221),("chr24",28669200),("chr25",7542176),("chr29",49630960),("chr3",55978642),("chr4",71036474),("chr4",81321187),("chr6",75231278),("chr7",54564143),("chr8",39201327),("chr8",99508382),("chr9",9072644),("chr9",22651205),("chr29",2400293),("chr11",99542935),("chr12",1866865),("chr14",22331739),("chr15",18443426),("chr16",47362937),("chr18",20883315),("chr19",831054),("chr2",68601289),("chr22",57988022),("chr24",32228835),("chr25",26789542),("chr25",29145679),("chr26",6351844),("chr27",35796325),("chr29",20931278),("chr29",24712025),("chr29",37066663),("chr4",61502169),("chr4",61502171),("chr5",62613723),("chr7",48504799),("chr8",40252470),("chr9",2657499),("chr13",1420558),("chr7",14080385),("chr10",25601503),("chr8",99508382),("chr1",39434050),("chr10",32230331),("chr11",79256678),("chr13",3087575),("chr16",70310323),("chr20",42089994),("chr21",50195415),("chr22",46061272),("chr4",40421234),("chr4",81321187),("chr7",101440177),("chr9",22651205),("chr1",46357210),("chr11",99542935),("chr13",17408780),("chr13",35979690),("chr13",40507964),("chr14",39777566),("chr18",50959959),("chr18",20883315),("chr2",68601289),("chr22",57988022),("chr24",47951602),("chr24",32228835),("chr26",6351844),("chr27",43713859),("chr4",92151362),("chr4",1068823),("chr5",109847211),("chr5",62613723),("chr6",95460100),("chr7",111780669),("chr7",48504799),("chr8",40252470),("chr9",2657499),("chr11",40260473),("chr14",4311348),("chr15",2786265),("chr17",39809755),("chr19",60827900),("chr21",30967915),("chr21",39307747),("chr22",25137626),("chr7",41040466),("chr9",81123904),("chr9",101487292),("chr1",123008487),("chr10",91823409),("chr13",21761831),("chr13",48425486),("chr18",13124778),("chr2",3859116),("chr20",51580790),("chr21",24434654),("chr29",39754838),("chr5",25516499),("chr6",56097041),("chr6",56097048),("chr8",45825687),("chr9",13268551),("chr17",52331286),("chr17",52331293),("chr18",42163301),("chr22",43024852),("chr11",23336292),("chr16",29729644),("chr20",28659910),("chr22",35908891),("chr4",28732216),("chr9",37691531),("chr7",44614262),("chr9",43950350),("chr28",14967309),("chr15",78527416),("chr1",130052540),("chr14",23469956),("chr13",10607401),("chr27",42810469))


val input = new BufferedReader(new FileReader("/Users/chhar0/Dropbox/PHD-WORK/Analysis-June-2015-Paper/recombinations/Rates.txt"))

var data: Array[List[Tuple3[Float,Float,Double]]] = Array(Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil)
//Array 0-28 = chrs 1-29, [Start,End,Rate]

while (input.ready){
val line = input.readLine.split("\t")
//println(line(0).substring(3) + " " + (line(2).toFloat*100000000).toInt)
data(line(0).substring(3).toInt - 1) = (line(2).toFloat * 100000000,line(3).toFloat * 100000000,line(4).toDouble) :: data(line(0).substring(3).toInt -1)
}

val outRec = new BufferedWriter(new FileWriter("recombsPermu.txt"))
val outDenovo = new BufferedWriter(new FileWriter("denovoRecs.txt"))

for (i <- 1 to 10000){
while (counter <= sites){
val num = chroms(scala.util.Random.nextInt(29))
val pos = scala.util.Random.nextInt(num._2)

for (x <- data(num._1.substring(3).toInt -1)){
if (pos >= x._1 && pos <= x._2 ) {
print("\t" + x._3)
outRec.write(x._3 + "\n")
}
}
counter += 1
}
print("\n")
counter = 0
}


for (x <- targets){
for(tmp <- data(x._1.substring(3).toInt -1)){
if (x._2 >= tmp._1 && x._2 <= tmp._2 ) {
outDenovo.write(tmp._3 + "\n")
}
}
}

outRec.close
outDenovo.close